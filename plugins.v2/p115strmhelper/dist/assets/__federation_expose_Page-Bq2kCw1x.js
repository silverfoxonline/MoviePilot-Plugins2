import{importShared as e}from"./__federation_fn_import-B6DyUTOO.js";import{_ as l}from"./_plugin-vue_export-helper-BCo6x5W8.js";const{resolveComponent:a,createVNode:t,createElementVNode:i,withCtx:s,toDisplayString:n,createTextVNode:r,openBlock:o,createBlock:c,createCommentVNode:d,createElementBlock:u,renderList:m,Fragment:p,normalizeClass:f,mergeProps:g,withModifiers:_,withKeys:y}=await e("vue"),h={class:"plugin-page"},v={key:3,class:"my-1"},x={key:1},b={key:1,class:"text-center py-4"},k={class:"d-flex flex-wrap align-center gap-1 mt-1"},w={key:0,class:"text-grey"},C={key:1,class:"text-grey"},z={key:2,class:"text-grey"},P={class:"text-grey mt-1"},V={class:"path-mapping-item pa-2 border rounded-sm",style:{"background-color":"rgba(var(--v-theme-on-surface), 0.02)"}},M=["title"],S={class:"text-caption",style:{"line-height":"1.2"}},T=["title"],$={class:"text-caption",style:{"line-height":"1.2"}},U={key:1,class:"text-caption text-error mt-1"},E={class:"path-mapping-item pa-2 border rounded-sm",style:{"background-color":"rgba(var(--v-theme-on-surface), 0.02)"}},I=["title"],R={class:"text-caption",style:{"line-height":"1.2"}},L=["title"],F={class:"text-caption",style:{"line-height":"1.2"}},B={key:1,class:"text-caption text-error mt-1"},j={class:"path-mapping-item pa-2 border rounded-sm",style:{"background-color":"rgba(var(--v-theme-on-surface), 0.02)"}},A=["title"],H={class:"text-caption",style:{"line-height":"1.2"}},O=["title"],D={class:"text-caption",style:{"line-height":"1.2"}},N={key:1,class:"text-caption text-error mt-1"},W={class:"path-mapping-item pa-2 border rounded-sm",style:{"background-color":"rgba(var(--v-theme-on-surface), 0.02)"}},q=["title"],K={class:"text-caption",style:{"line-height":"1.2"}},G=["title"],J={class:"text-caption",style:{"line-height":"1.2"}},Z={key:1,class:"text-caption text-error mt-1"},Q={class:"path-item pa-2 border rounded-sm",style:{"background-color":"rgba(var(--v-theme-on-surface), 0.02)"}},X={class:"d-flex align-center"},Y=["title"],ee={class:"text-caption",style:{"line-height":"1.2"}},le={key:1,class:"text-caption text-error mt-1"},ae={class:"path-group-item pa-2 border rounded-sm",style:{"background-color":"rgba(var(--v-theme-on-surface), 0.02)"}},te=["title"],ie={class:"text-caption",style:{"line-height":"1.2"}},se=["title"],ne={class:"text-caption",style:{"line-height":"1.2"}},re={key:0,class:"mt-1 pt-1",style:{"border-top":"1px dashed rgba(var(--v-border-color), 0.2)"}},oe={key:0,class:"d-flex align-center"},ce=["title"],de={class:"text-caption",style:{"line-height":"1.2"}},ue={key:1,class:"text-caption text-error mt-1"},me={class:"d-flex"},pe={class:"text-body-2"},fe={class:"d-flex"},ge={class:"text-body-2"},_e={class:"d-flex align-center",style:{gap:"4px"}},ye={class:"d-flex flex-column"},he={key:0,class:"mb-1"},ve={key:1,class:"text-grey"},xe={class:"d-flex flex-wrap ga-2 mt-1"},be={key:0},ke={key:1},we={class:"d-flex align-center"},Ce={class:"d-flex align-center"},ze={key:0},Pe={class:"d-flex align-center"},Ve={class:"d-flex align-center"},Me={class:"d-flex align-center"},Se={class:"d-flex align-center"},Te={class:"text-no-wrap text-caption font-weight-medium",style:{"min-width":"40px","text-align":"right"}},$e={class:"pa-3"},Ue={class:"d-flex justify-end mt-3"},Ee={key:0,class:"d-flex justify-center my-3"},Ie={key:1},Re={key:1,class:"text-center py-8"},Le={class:"d-flex flex-wrap align-center gap-1 mt-1"},Fe={key:0,class:"text-grey"},Be={key:1,class:"text-grey"},je={key:2,class:"text-grey"},Ae={key:0,class:"text-grey mt-1",style:{"word-break":"break-all"}},He={class:"text-grey mt-1"},{ref:Oe,reactive:De,computed:Ne,onMounted:We,onBeforeUnmount:qe,watch:Ke}=await e("vue"),Ge=l({__name:"Page",props:{api:{type:[Object,Function],required:!0},initialConfig:{type:Object,default:()=>({})}},emits:["close","switch","update:config","action"],setup(e,{emit:l}){const Ge=e,Je=l,Ze=e=>{if(!e||"string"!=typeof e)return 0;const l=e.trim().match(/^(\d*\.?\d+)\s*(k|m|g|t)?b?$/i);if(!l)return 0;const a=parseFloat(l[1]);switch((l[2]||"").toLowerCase()){case"t":return Math.round(1024*a*1024*1024*1024);case"g":return Math.round(1024*a*1024*1024);case"m":return Math.round(1024*a*1024);case"k":return Math.round(1024*a);default:return Math.round(a)}},Qe=(e,l=2)=>{if(!+e)return"";const a=l<0?0:l,t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(a))} ${["B","K","M","G","T"][t]}`},Xe=Oe(!0),Ye=Oe(!1),el=Oe(!1),ll=Oe(!1),al=Oe(!1),tl=Oe(!1),il=Oe(!1),sl=Oe(null),nl=Oe(null),rl=Oe("info"),ol=Oe(!1),cl=Oe(!1),dl=Oe(!1),ul=Oe([]),ml=Oe(!1),pl=Oe(null);let fl=null;const gl=Ne(()=>ul.value.slice(0,6)),_l=De({show:!1}),yl=De({enabled:!1,has_client:!1,running:!1}),hl=De({name:null,is_vip:null,is_forever_vip:null,vip_expire_date:null,avatar:null,error:null,loading:!0}),vl=De({total:null,used:null,remaining:null,error:null,loading:!0}),xl=De({show:!1,activeTab:"tasks",loading:!1,adding:!1,error:null,addError:null,tasks:[],totalTasks:0,itemsPerPage:10,headers:[{title:"文件名",key:"name",align:"start",sortable:!1,minWidth:"200px"},{title:"大小",key:"size_text",align:"end",sortable:!1,cellProps:{class:"text-no-wrap"},minWidth:"80px"},{title:"状态",key:"status_text",align:"center",sortable:!1,minWidth:"80px"},{title:"进度",key:"progress",align:"start",sortable:!1,minWidth:"120px"}],links:"",destPath:""}),bl=(e,l)=>{if(!e||!l)return 0;const a=e=>{if(!e||"string"!=typeof e)return 0;const l=parseFloat(e);return isNaN(l)?0:e.toUpperCase().includes("TB")?1024*l*1024:e.toUpperCase().includes("GB")?1024*l:(e.toUpperCase().includes("MB"),l)},t=a(e),i=a(l);return 0===i?0:Math.min(Math.max(t/i*100,0),100)},kl=Ne(()=>{if(!Ge.initialConfig)return!1;if(!(Ge.initialConfig.enabled&&Ge.initialConfig.cookies&&Ge.initialConfig.moviepilot_address))return!1;const e=wl(Ge.initialConfig.transfer_monitor_paths)>0&&Ge.initialConfig.transfer_monitor_enabled,l=wl(Ge.initialConfig.full_sync_strm_paths)>0&&Ge.initialConfig.timing_full_sync_strm,a=wl(Ge.initialConfig.increment_sync_strm_paths)>0&&Ge.initialConfig.increment_sync_strm_enabled,t=wl(Ge.initialConfig.monitor_life_paths)>0&&Ge.initialConfig.monitor_life_enabled,i=Array.isArray(Ge.initialConfig.share_strm_config)&&Ge.initialConfig.share_strm_config.length>0;return e||l||a||t||i}),wl=e=>{if(!e)return 0;try{return e.split("\n").filter(e=>e.trim()&&e.includes("#")).length}catch(l){return console.error("解析路径字符串失败:",l),0}},Cl=e=>{if(!e)return 0;try{return e.split("\n").filter(e=>e.trim()).length}catch(l){return console.error("解析网盘整理路径字符串失败:",l),0}},zl=async()=>{Xe.value=!0,sl.value=null;try{const l="P115StrmHelper",a=await Ge.api.get(`plugin/${l}/get_status`);if(!a||0!==a.code||!a.data){if(Ge.initialConfig){if(yl.enabled=Boolean(Ge.initialConfig.enabled),yl.has_client=Boolean(Ge.initialConfig.cookies&&""!==Ge.initialConfig.cookies.trim()),yl.running=!1,il.value=!0,Object.keys(Ge.initialConfig).length<=1)try{const e=await Ge.api.get(`plugin/${l}/get_config`);e&&(Object.assign(Ge.initialConfig,e),console.log("从配置API获取配置:",Ge.initialConfig))}catch(e){console.error("获取配置失败:",e)}throw new Error("状态API调用失败，使用配置数据显示状态")}throw new Error(a?.msg||"获取状态失败，请检查网络连接")}yl.enabled=Boolean(a.data.enabled),yl.has_client=Boolean(a.data.has_client),yl.running=Boolean(a.data.running);try{const e=await Ge.api.get(`plugin/${l}/get_config`);e&&(Object.assign(Ge.initialConfig,e),console.log("已获取最新配置:",Ge.initialConfig))}catch(e){console.error("获取配置失败:",e)}il.value=!0}catch(l){l.message.includes("使用配置数据显示状态")||(sl.value=`获取状态失败: ${l.message||"未知错误"}`),console.error("获取状态失败:",l)}finally{Xe.value=!1}},Pl=async()=>{Ye.value=!0,await zl(),yl.has_client&&Ge.initialConfig?.cookies?await sa():(hl.loading=!1,vl.loading=!1,Ge.initialConfig?.cookies?yl.has_client||(hl.error="115客户端未连接或Cookie无效。",vl.error="115客户端未连接或Cookie无效。"):(hl.error="请先配置115 Cookie。",vl.error="请先配置115 Cookie。")),Ye.value=!1,nl.value="状态已刷新",rl.value="success",setTimeout(()=>{nl.value=null},3e3)},Vl=async()=>{cl.value=!1,await Sl()},Ml=async()=>{dl.value=!1,await Tl()},Sl=async()=>{el.value=!0,ol.value=!0,sl.value=null,nl.value=null;try{if(!yl.enabled)throw new Error("插件未启用，请先在配置页面启用插件");if(!yl.has_client)throw new Error("插件未配置Cookie或Cookie无效，请先在配置页面设置115 Cookie");if(0===wl(Ge.initialConfig?.full_sync_strm_paths))throw new Error("未配置全量同步路径，请先在配置页面设置同步路径");const e="P115StrmHelper",l=await Ge.api.post(`plugin/${e}/full_sync`);if(!l||0!==l.code)throw new Error(l?.msg||"启动全量同步失败");nl.value=l.msg||"全量同步任务已启动",rl.value="success",await zl()}catch(e){sl.value=`启动全量同步失败: ${e.message||"未知错误"}`,console.error("启动全量同步失败:",e)}finally{el.value=!1,ol.value=!1}},Tl=async()=>{ll.value=!0,ol.value=!0,sl.value=null,nl.value=null;try{if(!yl.enabled)throw new Error("插件未启用，请先在配置页面启用插件");if(!yl.has_client)throw new Error("插件未配置Cookie或Cookie无效，请先在配置页面设置115 Cookie");const e="P115StrmHelper",l=await Ge.api.post(`plugin/${e}/full_sync_db`);if(!l||0!==l.code)throw new Error(l?.msg||"启动全量同步数据库失败");nl.value=l.msg||"全量同步数据库任务已启动",rl.value="success",await zl()}catch(e){sl.value=`启动全量同步数据库失败: ${e.message||"未知错误"}`,console.error("启动全量同步数据库失败:",e)}finally{ll.value=!1,ol.value=!1}},$l=De({show:!1,error:null,configs:[],globalMediaservers:[],globalMpMediaserverPaths:""}),Ul=De({show:!1,error:null,editingIndex:-1,shareLink:"",shareCode:"",shareReceive:"",sharePath:"/",localPath:"",minFileSizeFormatted:"",moviepilotTransfer:!1,autoDownloadMediainfo:!1,mediaServerRefresh:!1,scrapeMetadata:!1}),El=Oe([]),Il=Ne(()=>$l.configs.length>0&&$l.configs.every(e=>!!e.local_path&&(!(!e.share_link&&!e.share_code)&&!(e.share_code&&!e.share_receive)))),Rl=Ne(()=>!!Ul.localPath&&(!(!Ul.shareLink&&!Ul.shareCode)&&!(Ul.shareCode&&!Ul.shareReceive))),Ll=De({show:!1,isLocal:!0,loading:!1,error:null,currentPath:"/",items:[],selectedPath:"",callback:null}),Fl=()=>{$l.show=!0,$l.error=null,Ge.initialConfig&&($l.configs=Array.isArray(Ge.initialConfig.share_strm_config)?JSON.parse(JSON.stringify(Ge.initialConfig.share_strm_config)):[],$l.globalMediaservers=Array.isArray(Ge.initialConfig.share_strm_mediaservers)?[...Ge.initialConfig.share_strm_mediaservers]:[],$l.globalMpMediaserverPaths=Ge.initialConfig.share_strm_mp_mediaserver_paths||"")},Bl=()=>{$l.show=!1,$l.configs=[],$l.error=null},jl=()=>{Ul.editingIndex=-1,Ul.shareLink="",Ul.shareCode="",Ul.shareReceive="",Ul.sharePath="/",Ul.localPath="",Ul.minFileSizeFormatted="",Ul.moviepilotTransfer=!1,Ul.autoDownloadMediainfo=!1,Ul.mediaServerRefresh=!1,Ul.scrapeMetadata=!1,Ul.error=null,Ul.show=!0},Al=()=>{0!==$l.configs.length&&confirm("确定要清空所有分享配置吗？此操作不可恢复。")&&($l.configs=[])},Hl=async()=>{tl.value=!0,$l.error=null;try{const e="P115StrmHelper";if(!Ge.initialConfig)throw new Error("配置对象不存在");{Ge.initialConfig.share_strm_config=$l.configs,Ge.initialConfig.share_strm_mediaservers=$l.globalMediaservers.length>0?[...$l.globalMediaservers]:null,Ge.initialConfig.share_strm_mp_mediaserver_paths=$l.globalMpMediaserverPaths||null;const l=await Ge.api.post(`plugin/${e}/save_config`,Ge.initialConfig);if(!l||0!==l.code)throw new Error(l?.msg||"保存配置失败");nl.value="分享配置已保存",rl.value="success",await zl(),Bl()}}catch(e){$l.error=`保存配置失败: ${e.message||"未知错误"}`,console.error("保存配置失败:",e)}finally{tl.value=!1}},Ol=()=>{Ul.show=!1,Ul.editingIndex=-1,Ul.error=null},Dl=()=>{if(Ul.error=null,!Rl.value)return void(Ul.error="请填写必填项");const e={share_link:Ul.shareLink||null,share_code:Ul.shareCode||null,share_receive:Ul.shareReceive||null,share_path:Ul.sharePath||null,local_path:Ul.localPath,min_file_size:Ze(Ul.minFileSizeFormatted)||null,moviepilot_transfer:Ul.moviepilotTransfer,auto_download_mediainfo:!Ul.moviepilotTransfer&&Ul.autoDownloadMediainfo,media_server_refresh:!Ul.moviepilotTransfer&&Ul.mediaServerRefresh,scrape_metadata:!Ul.moviepilotTransfer&&Ul.scrapeMetadata};Ul.editingIndex>=0?$l.configs[Ul.editingIndex]=e:$l.configs.push(e),Ol()},Nl=async()=>{Ll.loading=!0,Ll.error=null,Ll.items=[];try{if(Ll.isLocal)try{const e=await Ge.api.post("storage/list",{path:Ll.currentPath||"/",type:"share",flag:"ROOT"});if(!e||!Array.isArray(e))throw new Error("浏览目录失败：无效响应");Ll.items=e.filter(e=>"dir"===e.type).map(e=>({name:e.name,path:e.path,is_dir:!0})).sort((e,l)=>e.name.localeCompare(l.name,void 0,{numeric:!0,sensitivity:"base"}))}catch(sl){console.error("浏览本地目录失败:",sl),Ll.error=`浏览本地目录失败: ${sl.message||"未知错误"}`,Ll.items=[]}else{const e="P115StrmHelper";if(!Ge.initialConfig?.cookies||""===Ge.initialConfig?.cookies.trim())throw new Error("请先设置115 Cookie才能浏览网盘目录");const l=await Ge.api.get(`plugin/${e}/browse_dir?path=${encodeURIComponent(Ll.currentPath)}&is_local=${Ll.isLocal}`);if(!l||0!==l.code||!l.data)throw new Error(l?.msg||"获取网盘目录内容失败");Ll.items=l.data.items.filter(e=>e.is_dir),Ll.currentPath=l.data.path||Ll.currentPath}}catch(sl){console.error("加载目录内容失败:",sl),Ll.error=sl.message||"获取目录内容失败",(sl.message.includes("Cookie")||sl.message.includes("cookie"))&&(Ll.items=[])}finally{Ll.loading=!1}},Wl=()=>{const e=Ll.currentPath;if(!Ll.isLocal){if("/"===e)return;let l=e.replace(/\\/g,"/");l.length>1&&l.endsWith("/")&&(l=l.slice(0,-1));const a=l.substring(0,l.lastIndexOf("/"));return Ll.currentPath=""===a?"/":a,void Nl()}if("/"===e||"C:\\"===e||"C:/"===e)return;const l=e.replace(/\\/g,"/"),a=l.split("/").filter(Boolean);0===a.length?Ll.currentPath="/":1===a.length&&l.includes(":")?Ll.currentPath=a[0]+":/":(a.pop(),Ll.currentPath=0===a.length?"/":(l.startsWith("/")?"/":"")+a.join("/")+"/"),Nl()},ql=()=>{if(!Ll.currentPath)return;let e=Ll.currentPath;"/"===e||/^[a-zA-Z]:[\\\/]$/.test(e)||!e.endsWith("/")&&!e.endsWith("\\\\")||(e=e.slice(0,-1)),"function"==typeof Ll.callback&&Ll.callback(e),Kl()},Kl=()=>{Ll.show=!1,Ll.items=[],Ll.error=null},Gl=async()=>{al.value=!0,$l.error=null;try{if(0===$l.configs.length)throw new Error("请至少添加一个分享配置");const e="P115StrmHelper";Ge.initialConfig&&(Ge.initialConfig.share_strm_config=$l.configs,Ge.initialConfig.share_strm_mediaservers=$l.globalMediaservers.length>0?[...$l.globalMediaservers]:null,Ge.initialConfig.share_strm_mp_mediaserver_paths=$l.globalMpMediaserverPaths||null,await Ge.api.post(`plugin/${e}/save_config`,Ge.initialConfig));const l=await Ge.api.post(`plugin/${e}/share_sync`);if(!l||0!==l.code)throw new Error(l?.msg||"启动分享同步失败");nl.value=l.msg||"分享同步任务已启动",rl.value="success",await zl(),Bl()}catch(e){$l.error=`启动分享同步失败: ${e.message||"未知错误"}`,console.error("启动分享同步失败:",e)}finally{al.value=!1}},Jl=()=>{xl.show=!0,xl.activeTab="tasks",xl.error=null,xl.addError=null},Zl=()=>{xl.show=!1,xl.tasks=[],xl.totalTasks=0,xl.links="",xl.destPath=""},Ql=async({page:e,itemsPerPage:l})=>{xl.loading=!0,xl.error=null;try{const a="P115StrmHelper",t=await Ge.api.post(`plugin/${a}/offline_tasks`,{page:e,limit:l});if(!t||0!==t.code||!t.data)throw new Error(t?.msg||"获取离线任务列表失败");xl.tasks=t.data.tasks||[],xl.totalTasks=t.data.total||0}catch(a){xl.error=`获取任务失败: ${a.message||"未知错误"}`,console.error("获取离线任务失败:",a),xl.tasks=[],xl.totalTasks=0}finally{xl.loading=!1}},Xl=async()=>{if(xl.links.trim()){xl.adding=!0,xl.addError=null;try{const e="P115StrmHelper",l=xl.links.split("\n").map(e=>e.trim()).filter(Boolean),a=await Ge.api.post(`plugin/${e}/add_offline_task`,{links:l,path:xl.destPath||null});if(!a||0!==a.code)throw new Error(a?.msg||"添加离线任务失败");nl.value=a.msg||"离线任务添加成功",rl.value="success",xl.links="",xl.destPath="",xl.activeTab="tasks",Ql({page:1,itemsPerPage:xl.itemsPerPage})}catch(e){xl.addError=`添加任务失败: ${e.message||"未知错误"}`,console.error("添加离线任务失败:",e)}finally{xl.adding=!1}}else xl.addError="下载链接不能为空。"},Yl=()=>{Ll.show=!0,Ll.isLocal=!1,Ll.loading=!1,Ll.error=null,Ll.items=[],Ll.currentPath=xl.destPath||"/",Ll.callback=e=>{xl.destPath=e},Nl()},ea=e=>{switch(e){case 0:return"info";case 1:return"error";case 2:return"success";case 3:return"warning";default:return"grey"}},la=e=>{if(!e)return[];try{return e.split("\n").filter(e=>e.trim()&&e.includes("#")).map(e=>{const l=e.split("#");return{local:l[0]||"",remote:l[1]||""}})}catch(l){return console.error("解析路径字符串失败:",l),[]}},aa=e=>{if(!e)return[];try{return e.split("\n").filter(e=>e.trim()).map(e=>({path:e}))}catch(l){return console.error("解析网盘整理路径字符串失败:",l),[]}};Ke(()=>Ge.initialConfig,e=>{e&&(yl.enabled=e.enabled||!1,yl.has_client=Boolean(e.cookies&&""!==e.cookies.trim()),e.sync_del_enabled?(ta(),fl&&clearInterval(fl),fl=setInterval(()=>{Ge.initialConfig?.sync_del_enabled&&ta()},3e4)):(ul.value=[],fl&&(clearInterval(fl),fl=null)))},{immediate:!0});const ta=async()=>{if(Ge.initialConfig?.sync_del_enabled){ml.value=!0;try{const e="P115StrmHelper",l=await Ge.api.get(`plugin/${e}/get_sync_del_history`);l&&l.success&&l.data?ul.value=Array.isArray(l.data)?l.data.sort((e,l)=>{const a=new Date(e.del_time||0).getTime();return new Date(l.del_time||0).getTime()-a}):[]:ul.value=[]}catch(e){console.error("加载同步删除历史失败:",e),ul.value=[]}finally{ml.value=!1}}else ul.value=[]},ia=async e=>{if(e){pl.value=e;try{const l="P115StrmHelper",a=await Ge.api.get("system/config?key=app.api_token"),t=a?.value||"",i=await Ge.api.get(`plugin/${l}/delete_sync_del_history?key=${encodeURIComponent(e)}&apikey=${encodeURIComponent(t)}`);i&&i.success?(nl.value="删除成功",rl.value="success",await ta()):(nl.value=i?.message||"删除失败",rl.value="error")}catch(l){console.error("删除同步删除历史失败:",l),nl.value=`删除失败: ${l.message||"未知错误"}`,rl.value="error"}finally{pl.value=null}}};async function sa(){hl.loading=!0,hl.error=null,vl.loading=!0,vl.error=null;try{const e="P115StrmHelper",l=await Ge.api.get(`plugin/${e}/user_storage_status`);if(l&&l.success)l.user_info?Object.assign(hl,l.user_info):hl.error="未能获取有效的用户信息。",l.storage_info?Object.assign(vl,l.storage_info):vl.error="未能获取有效的存储空间信息。";else{const e=l?.error_message||"获取用户和存储信息失败。";hl.error=e,vl.error=e,(e.includes("Cookie")||e.includes("未配置"))&&(yl.has_client=!1)}}catch(e){console.error("获取用户/存储状态失败:",e);const l=`请求用户/存储状态时出错: ${e.message||"未知网络错误"}`;hl.error=l,vl.error=l}finally{hl.loading=!1,vl.loading=!1}}return We(async()=>{await zl(),yl.has_client&&Ge.initialConfig?.cookies?await sa():(hl.loading=!1,vl.loading=!1,Ge.initialConfig?.cookies?yl.has_client||(hl.error="115客户端未连接或Cookie无效。",vl.error="115客户端未连接或Cookie无效。"):(hl.error="请先配置115 Cookie。",vl.error="请先配置115 Cookie。"));try{const e="P115StrmHelper",l=await Ge.api.get(`plugin/${e}/get_config`);l&&l.mediaservers&&(El.value=l.mediaservers)}catch(e){console.error("加载媒体服务器列表失败:",e)}Ge.initialConfig?.sync_del_enabled&&(await ta(),fl=setInterval(()=>{Ge.initialConfig?.sync_del_enabled&&ta()},3e4))}),qe(()=>{fl&&(clearInterval(fl),fl=null)}),(l,Oe)=>{const De=a("v-icon"),Ne=a("v-card-title"),We=a("v-alert"),qe=a("v-skeleton-loader"),Ke=a("v-list-item-title"),Ge=a("v-chip"),Ze=a("v-list-item"),fl=a("v-divider"),zl=a("v-list"),Sl=a("v-card-text"),Tl=a("v-card"),sa=a("v-img"),na=a("v-avatar"),ra=a("v-list-item-subtitle"),oa=a("v-progress-linear"),ca=a("v-spacer"),da=a("v-btn"),ua=a("v-col"),ma=a("v-row"),pa=a("v-menu"),fa=a("v-card-actions"),ga=a("v-select"),_a=a("v-textarea"),ya=a("v-tooltip"),ha=a("v-dialog"),va=a("v-text-field"),xa=a("v-switch"),ba=a("v-expand-transition"),ka=a("v-tab"),wa=a("v-tabs"),Ca=a("v-data-table-server"),za=a("v-window-item"),Pa=a("v-window"),Va=a("v-progress-circular");return o(),u(p,null,[i("div",h,[t(Tl,{flat:"",class:"rounded border",style:{display:"flex","flex-direction":"column","max-height":"85vh"}},{default:s(()=>[t(Ne,{class:"text-subtitle-1 d-flex align-center px-3 py-1 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-file-link",class:"mr-2",color:"primary",size:"small"}),Oe[41]||(Oe[41]=i("span",null,"115网盘STRM助手",-1))]),_:1}),t(Sl,{class:"px-3 py-1",style:{"flex-grow":"1","overflow-y":"auto","padding-bottom":"48px"}},{default:s(()=>[sl.value?(o(),c(We,{key:0,type:"error",density:"compact",class:"mb-2",variant:"tonal",closable:""},{default:s(()=>[r(n(sl.value),1)]),_:1})):d("",!0),nl.value?(o(),c(We,{key:1,type:rl.value,density:"compact",class:"mb-2",variant:"tonal",closable:""},{default:s(()=>[r(n(nl.value),1)]),_:1},8,["type"])):d("",!0),Xe.value&&!il.value?(o(),c(qe,{key:2,type:"article, actions"})):d("",!0),il.value?(o(),u("div",v,[t(ma,null,{default:s(()=>[t(ua,{cols:"12",md:"6"},{default:s(()=>[t(Tl,{flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 d-flex align-center px-3 py-1 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-information",class:"mr-2",color:"primary",size:"small"}),Oe[42]||(Oe[42]=i("span",null,"系统状态",-1))]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[t(zl,{class:"bg-transparent pa-0"},{default:s(()=>[t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:yl.enabled?"success":"grey",icon:"mdi-power",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:yl.enabled?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(yl.enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[43]||(Oe[43]=[r("插件状态")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:yl.has_client&&e.initialConfig?.cookies?"success":"error",icon:"mdi-account-check",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:yl.has_client&&e.initialConfig?.cookies?"success":"error",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(yl.has_client&&e.initialConfig?.cookies?"已连接":"未连接"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[44]||(Oe[44]=[r("115客户端状态")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:yl.running?"warning":"success",icon:"mdi-play-circle",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:yl.running?"warning":"success",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(yl.running?"运行中":"空闲"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[45]||(Oe[45]=[r("任务状态")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(Tl,{flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 d-flex align-center px-3 py-1 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-account-box",class:"mr-2",color:"primary",size:"small"}),Oe[46]||(Oe[46]=i("span",null,"115账户信息",-1))]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[hl.loading||vl.loading?(o(),c(qe,{key:0,type:"list-item-avatar-three-line, list-item-three-line"})):(o(),u("div",x,[hl.error||vl.error?(o(),c(We,{key:0,type:"warning",density:"compact",class:"ma-2",variant:"tonal"},{default:s(()=>[r(n(hl.error||vl.error),1)]),_:1})):(o(),c(zl,{key:1,class:"bg-transparent pa-0"},{default:s(()=>[t(Ze,{class:"px-3 py-1"},{prepend:s(()=>[t(na,{size:"32",class:"mr-2"},{default:s(()=>[hl.avatar?(o(),c(sa,{key:0,src:hl.avatar,alt:hl.name},null,8,["src","alt"])):(o(),c(De,{key:1,icon:"mdi-account-circle"}))]),_:1})]),default:s(()=>[t(Ke,{class:"text-body-1 font-weight-medium"},{default:s(()=>[r(n(hl.name||"未知用户"),1)]),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-1"},{prepend:s(()=>[t(De,{color:hl.is_vip?"amber-darken-2":"grey",icon:"mdi-shield-crown",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:hl.is_vip?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(hl.is_vip?hl.is_forever_vip?"永久VIP":`VIP (至 ${hl.vip_expire_date||"N/A"})`:"非VIP"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[47]||(Oe[47]=[r("VIP状态")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-1"},{default:s(()=>[t(Ke,{class:"text-body-2 mb-1"},{default:s(()=>Oe[48]||(Oe[48]=[r("存储空间")])),_:1}),vl.used&&vl.total?(o(),c(ra,{key:0,class:"text-caption"},{default:s(()=>[r(" 已用 "+n(vl.used)+" / 总共 "+n(vl.total)+" (剩余 "+n(vl.remaining)+") ",1)]),_:1})):d("",!0),vl.used&&vl.total?(o(),c(oa,{key:1,"model-value":bl(vl.used,vl.total),color:"primary",height:"6",rounded:"",class:"mt-1"},null,8,["model-value"])):(o(),c(ra,{key:2,class:"text-caption text-grey"},{default:s(()=>Oe[49]||(Oe[49]=[r(" 存储信息不可用 ")])),_:1}))]),_:1})]),_:1}))]))]),_:1})]),_:1}),t(Tl,{flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 d-flex align-center px-3 py-1 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-puzzle",class:"mr-2",color:"primary",size:"small"}),Oe[50]||(Oe[50]=i("span",null,"功能配置",-1))]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[t(zl,{class:"bg-transparent pa-0"},{default:s(()=>[t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.transfer_monitor_enabled?"success":"grey",icon:"mdi-file-move",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.transfer_monitor_enabled?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.transfer_monitor_enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[51]||(Oe[51]=[r("监控MP整理")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.timing_full_sync_strm?"success":"grey",icon:"mdi-sync",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.timing_full_sync_strm?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.timing_full_sync_strm?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[52]||(Oe[52]=[r("定期全量同步")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.increment_sync_strm_enabled?"success":"grey",icon:"mdi-book-sync",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.increment_sync_strm_enabled?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.increment_sync_strm_enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[53]||(Oe[53]=[r("定期增量同步")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.monitor_life_enabled?"success":"grey",icon:"mdi-calendar-heart",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.monitor_life_enabled?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.monitor_life_enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[54]||(Oe[54]=[r("监控115生活事件")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.pan_transfer_enabled?"success":"grey",icon:"mdi-transfer",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.pan_transfer_enabled?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.pan_transfer_enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[55]||(Oe[55]=[r("网盘整理")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.clear_recyclebin_enabled||e.initialConfig?.clear_receive_path_enabled?"success":"grey",icon:"mdi-broom",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.clear_recyclebin_enabled||e.initialConfig?.clear_receive_path_enabled?"success":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.clear_recyclebin_enabled||e.initialConfig?.clear_receive_path_enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[56]||(Oe[56]=[r("定期清理")])),_:1})]),_:1}),t(fl,{class:"my-0"}),t(Ze,{class:"px-3 py-0",style:{"min-height":"34px"}},{prepend:s(()=>[t(De,{color:e.initialConfig?.sync_del_enabled?"warning":"grey",icon:"mdi-delete-sweep",size:"small"},null,8,["color"])]),append:s(()=>[t(Ge,{color:e.initialConfig?.sync_del_enabled?"warning":"grey",size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.initialConfig?.sync_del_enabled?"已启用":"已禁用"),1)]),_:1},8,["color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[57]||(Oe[57]=[r("同步删除")])),_:1})]),_:1}),t(fl,{class:"my-0"})]),_:1})]),_:1})]),_:1}),e.initialConfig?.sync_del_enabled?(o(),c(Tl,{key:0,flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 d-flex align-center px-3 py-1 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-history",class:"mr-2",color:"primary",size:"small"}),Oe[59]||(Oe[59]=i("span",null,"同步删除历史",-1)),t(ca),ul.value.length>6?(o(),c(da,{key:0,size:"x-small",variant:"text",onClick:Oe[0]||(Oe[0]=e=>_l.show=!0),"prepend-icon":"mdi-open-in-new"},{default:s(()=>[r(" 查看全部 ("+n(ul.value.length)+") ",1)]),_:1})):d("",!0),t(da,{icon:"",size:"x-small",variant:"text",onClick:ta,loading:ml.value,class:"ml-1"},{default:s(()=>[t(De,null,{default:s(()=>Oe[58]||(Oe[58]=[r("mdi-refresh")])),_:1})]),_:1},8,["loading"])]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[ml.value?(o(),c(qe,{key:0,type:"list-item-avatar-three-line@3"})):0===ul.value.length?(o(),u("div",b,[t(De,{icon:"mdi-information-outline",size:"large",color:"grey",class:"mb-2"}),Oe[60]||(Oe[60]=i("div",{class:"text-caption text-grey"},"暂无删除历史",-1))])):(o(),c(zl,{key:2,class:"bg-transparent pa-0"},{default:s(()=>[(o(!0),u(p,null,m(gl.value,(e,l)=>(o(),u(p,{key:e.unique||l},[t(Ze,{class:"px-3 py-2"},{prepend:s(()=>[t(na,{size:"48",rounded:"",class:"mr-3"},{default:s(()=>[e.image?(o(),c(sa,{key:0,src:e.image,alt:e.title,cover:""},null,8,["src","alt"])):(o(),c(De,{key:1,icon:"mdi-movie"}))]),_:2},1024)]),append:s(()=>[t(da,{icon:"",size:"x-small",variant:"text",color:"error",onClick:l=>ia(e.unique),loading:pl.value===e.unique},{default:s(()=>[t(De,null,{default:s(()=>Oe[61]||(Oe[61]=[r("mdi-delete")])),_:1})]),_:2},1032,["onClick","loading"])]),default:s(()=>[t(Ke,{class:"text-body-2 font-weight-medium"},{default:s(()=>[r(n(e.title),1)]),_:2},1024),t(ra,{class:"text-caption"},{default:s(()=>[i("div",k,[t(Ge,{size:"x-small",variant:"tonal",color:"primary"},{default:s(()=>[r(n(e.type),1)]),_:2},1024),e.year?(o(),u("span",w,"· "+n(e.year),1)):d("",!0),e.season?(o(),u("span",C,"· S"+n(String(e.season).padStart(2,"0")),1)):d("",!0),e.episode?(o(),u("span",z,"· E"+n(String(e.episode).padStart(2,"0")),1)):d("",!0)]),i("div",P,n(e.del_time),1)]),_:2},1024)]),_:2},1024),l<gl.value.length-1?(o(),c(fl,{key:0,class:"my-0"})):d("",!0)],64))),128))]),_:1}))]),_:1})]),_:1})):d("",!0)]),_:1}),t(ua,{cols:"12",md:"6"},{default:s(()=>[t(Tl,{flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 d-flex align-center px-3 py-1 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-folder-search",class:"mr-2",color:"primary",size:"small"}),Oe[62]||(Oe[62]=i("span",null,"路径配置",-1))]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[t(zl,{class:"bg-transparent pa-0"},{default:s(()=>[e.initialConfig?.transfer_monitor_enabled?(o(),c(Ze,{key:0,class:"px-3 py-2"},{default:s(()=>[i("div",null,[Oe[68]||(Oe[68]=i("div",{class:"text-body-2 font-weight-medium mb-1"},"监控MP整理路径",-1)),wl(e.initialConfig?.transfer_monitor_paths)>0?(o(!0),u(p,{key:0},m(la(e.initialConfig?.transfer_monitor_paths),(e,l)=>(o(),u(p,{key:`transfer-${l}`},[l>0?(o(),c(fl,{key:0,class:"my-1"})):d("",!0),i("div",V,[t(ma,{dense:"",align:"center"},{default:s(()=>[t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"primary",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[63]||(Oe[63]=[r("mdi-folder-home")])),_:1}),i("div",{class:"text-truncate w-100",title:e.local},[Oe[64]||(Oe[64]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"本地目录",-1)),i("span",S,n(e.local||"-"),1)],8,M)]),_:2},1024),t(ua,{cols:"12",sm:"2",class:"text-center my-1 my-sm-0"},{default:s(()=>[t(De,{color:"primary",class:"icon-spin-animation"},{default:s(()=>Oe[65]||(Oe[65]=[r("mdi-sync")])),_:1})]),_:1}),t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"success",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[66]||(Oe[66]=[r("mdi-cloud")])),_:1}),i("div",{class:"text-truncate w-100",title:e.remote},[Oe[67]||(Oe[67]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"网盘目录",-1)),i("span",$,n(e.remote||"-"),1)],8,T)]),_:2},1024)]),_:2},1024)])],64))),128)):(o(),u("div",U,"未配置路径"))])]),_:1})):d("",!0),e.initialConfig?.transfer_monitor_enabled&&(e.initialConfig?.increment_sync_strm_enabled||e.initialConfig?.timing_full_sync_strm||e.initialConfig?.monitor_life_enabled||e.initialConfig?.pan_transfer_enabled||e.initialConfig?.directory_upload_enabled)?(o(),c(fl,{key:1,class:"my-0"})):d("",!0),e.initialConfig?.timing_full_sync_strm?(o(),c(Ze,{key:2,class:"px-3 py-2"},{default:s(()=>[i("div",null,[Oe[74]||(Oe[74]=i("div",{class:"text-body-2 font-weight-medium mb-1"},"全量同步路径",-1)),wl(e.initialConfig?.full_sync_strm_paths)>0?(o(!0),u(p,{key:0},m(la(e.initialConfig?.full_sync_strm_paths),(e,l)=>(o(),u(p,{key:`fullsync-${l}`},[l>0?(o(),c(fl,{key:0,class:"my-1"})):d("",!0),i("div",E,[t(ma,{dense:"",align:"center"},{default:s(()=>[t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"primary",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[69]||(Oe[69]=[r("mdi-folder-home")])),_:1}),i("div",{class:"text-truncate w-100",title:e.local},[Oe[70]||(Oe[70]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"本地目录",-1)),i("span",R,n(e.local||"-"),1)],8,I)]),_:2},1024),t(ua,{cols:"12",sm:"2",class:"text-center my-1 my-sm-0"},{default:s(()=>[t(De,{color:"primary",class:"icon-spin-animation"},{default:s(()=>Oe[71]||(Oe[71]=[r("mdi-sync")])),_:1})]),_:1}),t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"success",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[72]||(Oe[72]=[r("mdi-cloud")])),_:1}),i("div",{class:"text-truncate w-100",title:e.remote},[Oe[73]||(Oe[73]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"网盘目录",-1)),i("span",F,n(e.remote||"-"),1)],8,L)]),_:2},1024)]),_:2},1024)])],64))),128)):(o(),u("div",B,"未配置路径"))])]),_:1})):d("",!0),e.initialConfig?.timing_full_sync_strm&&(e.initialConfig?.increment_sync_strm_enabled||e.initialConfig?.monitor_life_enabled||e.initialConfig?.pan_transfer_enabled||e.initialConfig?.directory_upload_enabled)?(o(),c(fl,{key:3,class:"my-0"})):d("",!0),e.initialConfig?.increment_sync_strm_enabled?(o(),c(Ze,{key:4,class:"px-3 py-2"},{default:s(()=>[i("div",null,[Oe[80]||(Oe[80]=i("div",{class:"text-body-2 font-weight-medium mb-1"},"增量同步路径",-1)),wl(e.initialConfig?.increment_sync_strm_paths)>0?(o(!0),u(p,{key:0},m(la(e.initialConfig?.increment_sync_strm_paths),(e,l)=>(o(),u(p,{key:`incsync-${l}`},[l>0?(o(),c(fl,{key:0,class:"my-1"})):d("",!0),i("div",j,[t(ma,{dense:"",align:"center"},{default:s(()=>[t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"primary",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[75]||(Oe[75]=[r("mdi-folder-home")])),_:1}),i("div",{class:"text-truncate w-100",title:e.local},[Oe[76]||(Oe[76]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"本地目录",-1)),i("span",H,n(e.local||"-"),1)],8,A)]),_:2},1024),t(ua,{cols:"12",sm:"2",class:"text-center my-1 my-sm-0"},{default:s(()=>[t(De,{color:"primary",class:"icon-spin-animation"},{default:s(()=>Oe[77]||(Oe[77]=[r("mdi-sync")])),_:1})]),_:1}),t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"success",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[78]||(Oe[78]=[r("mdi-cloud")])),_:1}),i("div",{class:"text-truncate w-100",title:e.remote},[Oe[79]||(Oe[79]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"网盘目录",-1)),i("span",D,n(e.remote||"-"),1)],8,O)]),_:2},1024)]),_:2},1024)])],64))),128)):(o(),u("div",N,"未配置路径"))])]),_:1})):d("",!0),e.initialConfig?.increment_sync_strm_enabled&&(e.initialConfig?.monitor_life_enabled||e.initialConfig?.pan_transfer_enabled||e.initialConfig?.directory_upload_enabled)?(o(),c(fl,{key:5,class:"my-0"})):d("",!0),e.initialConfig?.monitor_life_enabled?(o(),c(Ze,{key:6,class:"px-3 py-2"},{default:s(()=>[i("div",null,[Oe[86]||(Oe[86]=i("div",{class:"text-body-2 font-weight-medium mb-1"},"监控115生活事件路径",-1)),wl(e.initialConfig?.monitor_life_paths)>0?(o(!0),u(p,{key:0},m(la(e.initialConfig?.monitor_life_paths),(e,l)=>(o(),u(p,{key:`life-${l}`},[l>0?(o(),c(fl,{key:0,class:"my-1"})):d("",!0),i("div",W,[t(ma,{dense:"",align:"center"},{default:s(()=>[t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"primary",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[81]||(Oe[81]=[r("mdi-folder-home")])),_:1}),i("div",{class:"text-truncate w-100",title:e.local},[Oe[82]||(Oe[82]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"本地目录",-1)),i("span",K,n(e.local||"-"),1)],8,q)]),_:2},1024),t(ua,{cols:"12",sm:"2",class:"text-center my-1 my-sm-0"},{default:s(()=>[t(De,{color:"primary",class:"icon-spin-animation"},{default:s(()=>Oe[83]||(Oe[83]=[r("mdi-sync")])),_:1})]),_:1}),t(ua,{cols:"12",sm:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"success",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[84]||(Oe[84]=[r("mdi-cloud")])),_:1}),i("div",{class:"text-truncate w-100",title:e.remote},[Oe[85]||(Oe[85]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"网盘目录",-1)),i("span",J,n(e.remote||"-"),1)],8,G)]),_:2},1024)]),_:2},1024)])],64))),128)):(o(),u("div",Z,"未配置路径"))])]),_:1})):d("",!0),e.initialConfig?.monitor_life_enabled&&(e.initialConfig?.pan_transfer_enabled||e.initialConfig?.directory_upload_enabled)?(o(),c(fl,{key:7,class:"my-0"})):d("",!0),e.initialConfig?.pan_transfer_enabled?(o(),c(Ze,{key:8,class:"px-3 py-2"},{default:s(()=>[i("div",null,[Oe[89]||(Oe[89]=i("div",{class:"text-body-2 font-weight-medium mb-1"},"网盘整理目录",-1)),Cl(e.initialConfig?.pan_transfer_paths)>0?(o(!0),u(p,{key:0},m(aa(e.initialConfig?.pan_transfer_paths),(e,l)=>(o(),u(p,{key:`pan-${l}`},[l>0?(o(),c(fl,{key:0,class:"my-1"})):d("",!0),i("div",Q,[i("div",X,[t(De,{size:"small",color:"success",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[87]||(Oe[87]=[r("mdi-folder-arrow-down")])),_:1}),i("div",{class:"text-truncate w-100",title:e.path},[Oe[88]||(Oe[88]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"待整理网盘目录",-1)),i("span",ee,n(e.path),1)],8,Y)])])],64))),128)):(o(),u("div",le,"未配置网盘整理目录"))])]),_:1})):d("",!0),e.initialConfig?.pan_transfer_enabled&&e.initialConfig?.directory_upload_enabled?(o(),c(fl,{key:9,class:"my-0"})):d("",!0),e.initialConfig?.directory_upload_enabled?(o(),c(Ze,{key:10,class:"px-3 py-2"},{default:s(()=>[i("div",null,[Oe[97]||(Oe[97]=i("div",{class:"text-body-2 font-weight-medium mb-1"},"目录上传路径",-1)),e.initialConfig?.directory_upload_path&&e.initialConfig.directory_upload_path.length>0?(o(!0),u(p,{key:0},m(e.initialConfig.directory_upload_path,(e,l)=>(o(),u(p,{key:`upload-group-${l}`},[l>0?(o(),c(fl,{key:0,class:"my-1"})):d("",!0),i("div",ae,[t(ma,{dense:"",align:"center"},{default:s(()=>[t(ua,{cols:"12",md:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"primary",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[90]||(Oe[90]=[r("mdi-folder-table")])),_:1}),i("div",{class:"text-truncate w-100",title:e.src},[Oe[91]||(Oe[91]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"本地监控",-1)),i("span",ie,n(e.src||"-"),1)],8,te)]),_:2},1024),t(ua,{cols:"12",md:"2",class:"text-center my-1 my-md-0"},{default:s(()=>[t(De,{color:"primary",class:"icon-spin-animation"},{default:s(()=>Oe[92]||(Oe[92]=[r("mdi-sync")])),_:1})]),_:1}),t(ua,{cols:"12",md:"5",class:"d-flex align-center"},{default:s(()=>[t(De,{size:"small",color:"success",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[93]||(Oe[93]=[r("mdi-cloud-upload")])),_:1}),i("div",{class:"text-truncate w-100",title:e.dest_remote},[Oe[94]||(Oe[94]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"网盘上传",-1)),i("span",ne,n(e.dest_remote||"-"),1)],8,se)]),_:2},1024)]),_:2},1024),e.dest_local||"boolean"==typeof e.delete?(o(),u("div",re,[t(ma,{dense:"",align:"center",class:"mt-1"},{default:s(()=>[t(ua,{cols:"12",md:"boolean"==typeof e.delete?7:12},{default:s(()=>[e.dest_local?(o(),u("div",oe,[t(De,{size:"small",color:"warning",class:"mr-2 flex-shrink-0"},{default:s(()=>Oe[95]||(Oe[95]=[r("mdi-content-copy")])),_:1}),i("div",{class:"text-truncate w-100",title:e.dest_local},[Oe[96]||(Oe[96]=i("span",{class:"text-caption font-weight-medium d-block",style:{"line-height":"1.2"}},"本地复制",-1)),i("span",de,n(e.dest_local),1)],8,ce)])):d("",!0)]),_:2},1032,["md"]),"boolean"==typeof e.delete?(o(),c(ua,{key:0,cols:"12",md:e.dest_local?5:12,class:f(["d-flex align-center",{"justify-md-end":e.dest_local,"mt-1 mt-md-0":e.dest_local}])},{default:s(()=>[t(De,{size:"small",color:e.delete?"error":"grey-darken-1",class:"mr-1 flex-shrink-0"},{default:s(()=>[r(n(e.delete?"mdi-delete":"mdi-delete-off"),1)]),_:2},1032,["color"]),i("span",{class:f(["text-caption",e.delete?"text-error":"text-grey-darken-1"])},n(e.delete?"删除源":"不删源"),3)]),_:2},1032,["md","class"])):d("",!0)]),_:2},1024)])):d("",!0)])],64))),128)):(o(),u("div",ue,"未配置路径"))])]),_:1})):d("",!0)]),_:1})]),_:1})]),_:1}),yl.has_client&&e.initialConfig.cookies?kl.value?d("",!0):(o(),c(Tl,{key:1,flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Sl,{class:"pa-3"},{default:s(()=>[i("div",fe,[t(De,{icon:"mdi-alert-circle",color:"warning",class:"mr-2",size:"small"}),i("div",ge,[Oe[104]||(Oe[104]=i("p",{class:"mb-1"},[i("strong",null,"路径配置不完整")],-1)),Oe[105]||(Oe[105]=i("p",{class:"mb-0"},"您已配置115 Cookie，但部分功能路径未配置。请前往配置页面完善路径设置。",-1)),t(da,{color:"primary",variant:"text",size:"small",class:"mt-1 px-2 py-0",onClick:Oe[2]||(Oe[2]=e=>Je("switch"))},{default:s(()=>[t(De,{size:"small",class:"mr-1"},{default:s(()=>Oe[102]||(Oe[102]=[r("mdi-cog")])),_:1}),Oe[103]||(Oe[103]=r("前往配置 "))]),_:1})])])]),_:1})]),_:1})):(o(),c(Tl,{key:0,flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Sl,{class:"pa-3"},{default:s(()=>[i("div",me,[t(De,{icon:"mdi-alert-circle",color:"error",class:"mr-2",size:"small"}),i("div",pe,[Oe[100]||(Oe[100]=i("p",{class:"mb-1"},[i("strong",null,"未配置115 Cookie或Cookie无效")],-1)),Oe[101]||(Oe[101]=i("p",{class:"mb-0"},"请在配置页面中设置有效的115网盘Cookie，可通过扫码登录获取。",-1)),t(da,{color:"primary",variant:"text",size:"small",class:"mt-1 px-2 py-0",onClick:Oe[1]||(Oe[1]=e=>Je("switch"))},{default:s(()=>[t(De,{size:"small",class:"mr-1"},{default:s(()=>Oe[98]||(Oe[98]=[r("mdi-cog")])),_:1}),Oe[99]||(Oe[99]=r("前往配置 "))]),_:1})])])]),_:1})]),_:1}))]),_:1})]),_:1}),t(Tl,{flat:"",class:"rounded mb-3 border config-card"},{default:s(()=>[t(Sl,{class:"d-flex align-center px-3 py-1"},{default:s(()=>[t(De,{icon:"mdi-information",color:"info",class:"mr-2",size:"small"}),Oe[106]||(Oe[106]=i("span",{class:"text-body-2"},' 点击"配置"按钮进行设置，"全量同步"和"分享同步"按钮可立即执行相应任务。 ',-1))]),_:1})]),_:1})])):d("",!0)]),_:1}),t(fl),t(fa,{class:"px-2 py-1 sticky-actions d-flex justify-space-between align-center",style:{"flex-shrink":"0",gap:"8px"}},{default:s(()=>[t(da,{color:"info",onClick:Pl,"prepend-icon":"mdi-refresh",disabled:Ye.value,loading:Ye.value,variant:"text",size:"small"},{default:s(()=>Oe[107]||(Oe[107]=[r("刷新状态")])),_:1},8,["disabled","loading"]),i("div",_e,[t(pa,{"offset-y":""},{activator:s(({props:e})=>[t(da,g(e,{variant:"text",size:"small","append-icon":"mdi-dots-vertical"}),{default:s(()=>Oe[108]||(Oe[108]=[r(" 更多 ")])),_:2},1040)]),default:s(()=>[t(zl,{density:"compact"},{default:s(()=>[t(Ze,{onClick:Oe[3]||(Oe[3]=e=>cl.value=!0),disabled:!yl.enabled||!yl.has_client||ol.value},{prepend:s(()=>[t(De,{color:"warning"},{default:s(()=>Oe[109]||(Oe[109]=[r("mdi-sync")])),_:1})]),default:s(()=>[t(Ke,null,{default:s(()=>Oe[110]||(Oe[110]=[r("全量同步")])),_:1})]),_:1},8,["disabled"]),t(Ze,{onClick:Oe[4]||(Oe[4]=e=>dl.value=!0),disabled:!yl.enabled||!yl.has_client||ol.value},{prepend:s(()=>[t(De,{color:"primary"},{default:s(()=>Oe[111]||(Oe[111]=[r("mdi-database-sync")])),_:1})]),default:s(()=>[t(Ke,null,{default:s(()=>Oe[112]||(Oe[112]=[r("全量同步数据库")])),_:1})]),_:1},8,["disabled"]),t(Ze,{onClick:Fl,disabled:!yl.enabled||!yl.has_client||ol.value,loading:al.value},{prepend:s(()=>[t(De,{color:"info"},{default:s(()=>Oe[113]||(Oe[113]=[r("mdi-share-variant")])),_:1})]),default:s(()=>[t(Ke,null,{default:s(()=>Oe[114]||(Oe[114]=[r("分享同步")])),_:1})]),_:1},8,["disabled","loading"]),t(Ze,{onClick:Jl,disabled:!yl.enabled||!yl.has_client||ol.value},{prepend:s(()=>[t(De,{color:"secondary"},{default:s(()=>Oe[115]||(Oe[115]=[r("mdi-cloud-download-outline")])),_:1})]),default:s(()=>[t(Ke,null,{default:s(()=>Oe[116]||(Oe[116]=[r("离线下载")])),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1}),t(da,{color:"primary",onClick:Oe[5]||(Oe[5]=e=>Je("switch")),"prepend-icon":"mdi-cog",variant:"text",size:"small"},{default:s(()=>Oe[117]||(Oe[117]=[r("配置")])),_:1}),t(da,{color:"error",onClick:Oe[6]||(Oe[6]=e=>Je("close")),variant:"flat",size:"small",class:"custom-close-btn","aria-label":"关闭",style:{"min-width":"auto !important",padding:"0 10px !important",height:"28px !important","line-height":"28px !important"}},{default:s(()=>[t(De,{size:"small"},{default:s(()=>Oe[118]||(Oe[118]=[r("mdi-close")])),_:1})]),_:1})])]),_:1})]),_:1})]),t(ha,{modelValue:$l.show,"onUpdate:modelValue":Oe[9]||(Oe[9]=e=>$l.show=e),"max-width":"900",scrollable:""},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-subtitle-1 d-flex align-center px-3 py-1 bg-primary-lighten-5"},{default:s(()=>[t(De,{icon:"mdi-share-variant",class:"mr-2",color:"primary",size:"small"}),Oe[119]||(Oe[119]=i("span",null,"115网盘分享同步",-1)),t(ca),t(da,{icon:"mdi-close",variant:"text",size:"small",onClick:Bl})]),_:1}),t(Sl,{class:"px-3 py-2"},{default:s(()=>[$l.error?(o(),c(We,{key:0,type:"error",density:"compact",class:"mb-3",variant:"tonal"},{default:s(()=>[r(n($l.error),1)]),_:1})):d("",!0),t(Tl,{variant:"outlined",class:"mb-4"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 px-3 py-2 bg-grey-lighten-4"},{default:s(()=>[t(De,{icon:"mdi-cog",size:"small",class:"mr-2"}),Oe[120]||(Oe[120]=r(" 全局配置 "))]),_:1}),t(Sl,{class:"pa-3"},{default:s(()=>[t(ma,null,{default:s(()=>[t(ua,{cols:"12"},{default:s(()=>[t(ga,{modelValue:$l.globalMediaservers,"onUpdate:modelValue":Oe[7]||(Oe[7]=e=>$l.globalMediaservers=e),label:"刷新媒体服务器",hint:"应用于所有分享配置的媒体服务器刷新设置","persistent-hint":"",items:El.value,multiple:"",chips:"","closable-chips":"",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(ma,{class:"mt-2"},{default:s(()=>[t(ua,{cols:"12"},{default:s(()=>[t(_a,{modelValue:$l.globalMpMediaserverPaths,"onUpdate:modelValue":Oe[8]||(Oe[8]=e=>$l.globalMpMediaserverPaths=e),label:"MP-媒体库 目录转换",hint:"格式：媒体库路径#MP路径，多个用换行分隔。应用于所有分享配置","persistent-hint":"",variant:"outlined",density:"compact",rows:"3","auto-grow":"",placeholder:"例如:\n/media#/mp\n/nas#/movie"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Tl,{variant:"outlined"},{default:s(()=>[t(Ne,{class:"text-subtitle-2 px-3 py-2 bg-grey-lighten-4 d-flex align-center"},{default:s(()=>[t(De,{icon:"mdi-share-variant",size:"small",class:"mr-2"}),Oe[123]||(Oe[123]=i("span",{class:"flex-grow-1"},"分享配置列表",-1)),t(da,{size:"small","prepend-icon":"mdi-delete-sweep",variant:"text",color:"error",onClick:Al,disabled:0===$l.configs.length,title:"清空所有分享配置"},{default:s(()=>Oe[121]||(Oe[121]=[r(" 清空 ")])),_:1},8,["disabled"]),t(da,{size:"small","prepend-icon":"mdi-plus",variant:"tonal",color:"primary",onClick:jl,class:"ml-2"},{default:s(()=>Oe[122]||(Oe[122]=[r(" 添加分享 ")])),_:1})]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[$l.configs.length>0?(o(),c(zl,{key:0,class:"pa-0"},{default:s(()=>[(o(!0),u(p,null,m($l.configs,(e,l)=>(o(),u(p,{key:l},[t(Ze,{class:"px-3 py-2"},{prepend:s(()=>[t(De,{icon:"mdi-share-variant",color:"primary",size:"small",class:"mr-2"})]),append:s(()=>[i("div",we,[t(da,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:e=>(e=>{if(e<0||e>=$l.configs.length)return;const l=$l.configs[e];Ul.editingIndex=e,Ul.shareLink=l.share_link||"",Ul.shareCode=l.share_code||"",Ul.shareReceive=l.share_receive||"",Ul.sharePath=l.share_path||"/",Ul.localPath=l.local_path||"",Ul.minFileSizeFormatted=Qe(l.min_file_size||0),Ul.moviepilotTransfer=l.moviepilot_transfer||!1,Ul.autoDownloadMediainfo=l.auto_download_mediainfo||!1,Ul.mediaServerRefresh=l.media_server_refresh||!1,Ul.scrapeMetadata=l.scrape_metadata||!1,Ul.error=null,Ul.show=!0})(l),title:"编辑"},null,8,["onClick"]),t(da,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:e=>(e=>{e>=0&&e<$l.configs.length&&$l.configs.splice(e,1)})(l),title:"删除"},null,8,["onClick"])])]),default:s(()=>[t(Ke,{class:"text-body-2 font-weight-medium"},{default:s(()=>[r(n(e.share_link||e.share_code||`分享配置 ${l+1}`),1)]),_:2},1024),t(ra,{class:"text-caption mt-1"},{default:s(()=>[i("div",ye,[e.local_path?(o(),u("span",he,[t(De,{icon:"mdi-folder",size:"x-small",class:"mr-1"}),r(" 本地路径: "+n(e.local_path),1)])):(o(),u("span",ve,"未配置本地路径")),i("div",xe,[e.share_path&&"/"!==e.share_path?(o(),u("span",be,[t(De,{icon:"mdi-folder-network",size:"x-small",class:"mr-1"}),r(" 分享路径: "+n(e.share_path),1)])):d("",!0),e.min_file_size?(o(),u("span",ke,[t(De,{icon:"mdi-file-size",size:"x-small",class:"mr-1"}),r(" 最小文件: "+n(Qe(e.min_file_size)),1)])):d("",!0),e.moviepilot_transfer?(o(),c(Ge,{key:2,size:"x-small",color:"primary",variant:"tonal"},{default:s(()=>Oe[124]||(Oe[124]=[r(" MP整理 ")])),_:1})):d("",!0)])])]),_:2},1024)]),_:2},1024),l<$l.configs.length-1?(o(),c(fl,{key:0,class:"my-0"})):d("",!0)],64))),128))]),_:1})):(o(),c(We,{key:1,type:"info",density:"compact",variant:"tonal",class:"ma-3"},{default:s(()=>Oe[125]||(Oe[125]=[i("div",{class:"d-flex align-center"},[i("span",null,'暂无分享配置，请点击"添加分享"按钮添加')],-1)])),_:1}))]),_:1})]),_:1})]),_:1}),t(fl),t(fa,{class:"px-3 py-1"},{default:s(()=>[t(da,{color:"grey",variant:"text",onClick:Bl,size:"small"},{default:s(()=>Oe[126]||(Oe[126]=[r("取消")])),_:1}),t(ca),t(ya,{location:"top"},{activator:s(({props:e})=>[t(da,g({color:"info",variant:"text",onClick:Hl,loading:tl.value,size:"small"},e),{default:s(()=>Oe[127]||(Oe[127]=[r(" 保存配置 ")])),_:2},1040,["loading"])]),default:s(()=>[Oe[128]||(Oe[128]=i("span",null,"仅保存配置到系统，不执行同步任务",-1))]),_:1}),t(ya,{location:"top"},{activator:s(({props:e})=>[t(da,g({color:"primary",variant:"text",onClick:Gl,loading:al.value,disabled:!Il.value,size:"small",class:"ml-2"},e),{default:s(()=>Oe[129]||(Oe[129]=[r(" 保存并同步 ")])),_:2},1040,["loading","disabled"])]),default:s(()=>[Oe[130]||(Oe[130]=i("span",null,"保存配置并立即执行分享同步任务（需要至少一个有效配置）",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ha,{modelValue:Ul.show,"onUpdate:modelValue":Oe[21]||(Oe[21]=e=>Ul.show=e),"max-width":"700",scrollable:""},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-subtitle-1 d-flex align-center px-3 py-1 bg-primary-lighten-5"},{default:s(()=>[t(De,{icon:"mdi-share-variant",class:"mr-2",color:"primary",size:"small"}),i("span",null,n(Ul.editingIndex>=0?"编辑分享配置":"添加分享配置"),1),t(ca),t(da,{icon:"mdi-close",variant:"text",size:"small",onClick:Ol})]),_:1}),t(Sl,{class:"px-3 py-3"},{default:s(()=>[Ul.error?(o(),c(We,{key:0,type:"error",density:"compact",class:"mb-3",variant:"tonal",closable:""},{default:s(()=>[r(n(Ul.error),1)]),_:1})):d("",!0),t(ma,{class:"mb-2"},{default:s(()=>[t(ua,{cols:"12"},{default:s(()=>[t(va,{modelValue:Ul.shareLink,"onUpdate:modelValue":Oe[10]||(Oe[10]=e=>Ul.shareLink=e),label:"分享链接",hint:"115网盘分享链接","persistent-hint":"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-link"},null,8,["modelValue"])]),_:1})]),_:1}),t(ma,{class:"mb-2"},{default:s(()=>[t(ua,{cols:"12",md:"6"},{default:s(()=>[t(va,{modelValue:Ul.shareCode,"onUpdate:modelValue":Oe[11]||(Oe[11]=e=>Ul.shareCode=e),label:"分享码",hint:"分享码，和分享链接选填一项","persistent-hint":"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-key"},null,8,["modelValue"])]),_:1}),t(ua,{cols:"12",md:"6"},{default:s(()=>[t(va,{modelValue:Ul.shareReceive,"onUpdate:modelValue":Oe[12]||(Oe[12]=e=>Ul.shareReceive=e),label:"分享密码",hint:"分享密码，和分享链接选填一项","persistent-hint":"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-lock",type:"password"},null,8,["modelValue"])]),_:1})]),_:1}),t(ma,{class:"mb-2"},{default:s(()=>[t(ua,{cols:"12",md:"6"},{default:s(()=>[t(va,{modelValue:Ul.sharePath,"onUpdate:modelValue":Oe[13]||(Oe[13]=e=>Ul.sharePath=e),label:"分享路径",hint:"分享内容列表中的相对路径，默认为根目录 /","persistent-hint":"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-folder-network"},null,8,["modelValue"])]),_:1}),t(ua,{cols:"12",md:"6"},{default:s(()=>[t(va,{modelValue:Ul.localPath,"onUpdate:modelValue":Oe[14]||(Oe[14]=e=>Ul.localPath=e),label:"本地路径",hint:"本地生成STRM文件的路径","persistent-hint":"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-folder","append-icon":"mdi-folder-search","onClick:append":Oe[15]||(Oe[15]=e=>{return l="local",Ll.show=!0,Ll.isLocal="local"===l,Ll.loading=!1,Ll.error=null,Ll.items=[],Ll.currentPath=Ll.isLocal&&Ul.localPath||"/",Ll.callback=e=>{Ll.isLocal&&(Ul.localPath=e)},void Nl();var l})},null,8,["modelValue"])]),_:1})]),_:1}),t(ma,{class:"mb-2"},{default:s(()=>[t(ua,{cols:"12",md:"6"},{default:s(()=>[t(va,{modelValue:Ul.minFileSizeFormatted,"onUpdate:modelValue":Oe[16]||(Oe[16]=e=>Ul.minFileSizeFormatted=e),label:"分享生成最小文件大小",hint:"小于此值不生成STRM(K,M,G)","persistent-hint":"",variant:"outlined",density:"compact",placeholder:"例如: 100M",clearable:"","prepend-inner-icon":"mdi-file-document"},null,8,["modelValue"])]),_:1})]),_:1}),t(fl,{class:"my-3"}),t(ma,{class:"mb-2"},{default:s(()=>[t(ua,{cols:"12"},{default:s(()=>[t(xa,{modelValue:Ul.moviepilotTransfer,"onUpdate:modelValue":Oe[17]||(Oe[17]=e=>Ul.moviepilotTransfer=e),label:"STRM 交由 MoviePilot 整理",color:"primary",density:"compact","hide-details":""},{label:s(()=>[i("div",Ce,[t(De,{icon:"mdi-transfer",size:"small",class:"mr-2"}),Oe[131]||(Oe[131]=i("span",null,"STRM 交由 MoviePilot 整理",-1))])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(ba,null,{default:s(()=>[Ul.moviepilotTransfer?d("",!0):(o(),u("div",ze,[t(ma,{class:"mb-2"},{default:s(()=>[t(ua,{cols:"12",md:"4",class:"d-flex align-center"},{default:s(()=>[t(xa,{modelValue:Ul.autoDownloadMediainfo,"onUpdate:modelValue":Oe[18]||(Oe[18]=e=>Ul.autoDownloadMediainfo=e),color:"primary",density:"compact","hide-details":"",class:"flex-grow-1"},{label:s(()=>[i("div",Pe,[t(De,{icon:"mdi-download",size:"small",class:"mr-2"}),Oe[132]||(Oe[132]=i("span",null,"自动下载网盘元数据",-1))])]),_:1},8,["modelValue"])]),_:1}),t(ua,{cols:"12",md:"4",class:"d-flex align-center"},{default:s(()=>[t(xa,{modelValue:Ul.mediaServerRefresh,"onUpdate:modelValue":Oe[19]||(Oe[19]=e=>Ul.mediaServerRefresh=e),color:"primary",density:"compact","hide-details":"",class:"flex-grow-1"},{label:s(()=>[i("div",Ve,[t(De,{icon:"mdi-refresh",size:"small",class:"mr-2"}),Oe[133]||(Oe[133]=i("span",null,"刷新媒体服务器",-1))])]),_:1},8,["modelValue"])]),_:1}),t(ua,{cols:"12",md:"4",class:"d-flex align-center"},{default:s(()=>[t(xa,{modelValue:Ul.scrapeMetadata,"onUpdate:modelValue":Oe[20]||(Oe[20]=e=>Ul.scrapeMetadata=e),color:"primary",density:"compact","hide-details":"",class:"flex-grow-1"},{label:s(()=>[i("div",Me,[t(De,{icon:"mdi-file-search",size:"small",class:"mr-2"}),Oe[134]||(Oe[134]=i("span",null,"是否刮削元数据",-1))])]),_:1},8,["modelValue"])]),_:1})]),_:1})]))]),_:1}),t(We,{type:"info",variant:"tonal",density:"compact",class:"mt-3"},{default:s(()=>Oe[135]||(Oe[135]=[i("div",{class:"text-caption"},[i("div",{class:"mb-1"},[i("strong",null,"提示：")]),i("ul",{class:"ma-0 pl-4"},[i("li",null,"分享链接/分享码和分享密码只需要二选一配置即可"),i("li",null,"同时填写分享链接、分享码和分享密码时，优先读取分享链接"),i("li",null,"当 STRM交由MoviePilot整理 关闭时，才能配置自动下载网盘元数据、刷新媒体服务器和是否刮削元数据")])],-1)])),_:1})]),_:1}),t(fl),t(fa,{class:"px-3 py-1"},{default:s(()=>[t(da,{color:"grey",variant:"text",onClick:Ol,size:"small"},{default:s(()=>Oe[136]||(Oe[136]=[r("取消")])),_:1}),t(ca),t(da,{color:"primary",variant:"text",onClick:Dl,disabled:!Rl.value,size:"small"},{default:s(()=>Oe[137]||(Oe[137]=[r(" 保存 ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ha,{modelValue:xl.show,"onUpdate:modelValue":Oe[32]||(Oe[32]=e=>xl.show=e),"max-width":"800",persistent:""},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-subtitle-1 d-flex align-center px-3 py-1 bg-primary-lighten-5"},{default:s(()=>[t(De,{icon:"mdi-cloud-download-outline",class:"mr-2",color:"primary",size:"small"}),Oe[138]||(Oe[138]=i("span",null,"115离线下载",-1)),t(ca),t(da,{icon:"mdi-close",variant:"text",size:"small",onClick:Zl})]),_:1}),t(Sl,{class:"pa-0"},{default:s(()=>[t(wa,{modelValue:xl.activeTab,"onUpdate:modelValue":Oe[22]||(Oe[22]=e=>xl.activeTab=e),"bg-color":"primary-gradient",grow:""},{default:s(()=>[t(ka,{value:"tasks"},{default:s(()=>Oe[139]||(Oe[139]=[r("任务列表")])),_:1}),t(ka,{value:"add"},{default:s(()=>Oe[140]||(Oe[140]=[r("添加任务")])),_:1})]),_:1},8,["modelValue"]),t(Pa,{modelValue:xl.activeTab,"onUpdate:modelValue":Oe[31]||(Oe[31]=e=>xl.activeTab=e),touchless:""},{default:s(()=>[t(za,{value:"tasks"},{default:s(()=>[i("div",{style:{"overflow-x":"auto"},onTouchstart:Oe[26]||(Oe[26]=_(()=>{},["stop"])),onTouchmove:Oe[27]||(Oe[27]=_(()=>{},["stop"])),onTouchend:Oe[28]||(Oe[28]=_(()=>{},["stop"]))},[xl.error?(o(),c(We,{key:0,type:"error",density:"compact",class:"ma-3",variant:"tonal"},{default:s(()=>[r(n(xl.error),1)]),_:1})):d("",!0),t(Ca,{headers:xl.headers,items:xl.tasks,"items-length":xl.totalTasks,loading:xl.loading,"items-per-page":xl.itemsPerPage,"onUpdate:options":Ql,density:"compact",class:"ma-2","no-data-text":"没有离线下载任务","loading-text":"正在加载任务...","items-per-page-text":"每页条目数",style:{"min-width":"700px"},onTouchstart:Oe[23]||(Oe[23]=_(()=>{},["stop"])),onTouchmove:Oe[24]||(Oe[24]=_(()=>{},["stop"])),onTouchend:Oe[25]||(Oe[25]=_(()=>{},["stop"]))},{"item.progress":s(({item:e})=>[i("div",Se,[t(oa,{"model-value":e.percent,color:ea(e.status),stream:0===e.status||3===e.status,striped:0===e.status||3===e.status,height:"8",rounded:"",class:"flex-grow-1 mr-3"},null,8,["model-value","color","stream","striped"]),i("div",Te,n(e.percent)+"% ",1)])]),"item.status_text":s(({item:e})=>[t(Ge,{color:ea(e.status),size:"x-small",variant:"tonal"},{default:s(()=>[r(n(e.status_text),1)]),_:2},1032,["color"])]),_:1},8,["headers","items","items-length","loading","items-per-page"])],32)]),_:1}),t(za,{value:"add"},{default:s(()=>[i("div",$e,[xl.addError?(o(),c(We,{key:0,type:"error",density:"compact",class:"mb-3",variant:"tonal"},{default:s(()=>[r(n(xl.addError),1)]),_:1})):d("",!0),t(_a,{modelValue:xl.links,"onUpdate:modelValue":Oe[29]||(Oe[29]=e=>xl.links=e),label:"下载链接",hint:"每行一个链接，支持 http(s)/ftp/magnet/ed2k","persistent-hint":"",variant:"outlined",rows:"5",clearable:""},null,8,["modelValue"]),t(va,{modelValue:xl.destPath,"onUpdate:modelValue":Oe[30]||(Oe[30]=e=>xl.destPath=e),label:"网盘保存路径 (可选)",hint:"可选，默认为网盘待整理目录","persistent-hint":"",variant:"outlined",density:"compact",class:"mt-3","append-inner-icon":"mdi-folder-network-outline","onClick:appendInner":Yl,clearable:""},null,8,["modelValue"]),i("div",Ue,[t(da,{color:"primary",onClick:Xl,loading:xl.adding,disabled:!xl.links||xl.adding,"prepend-icon":"mdi-plus"},{default:s(()=>Oe[141]||(Oe[141]=[r(" 添加任务 ")])),_:1},8,["loading","disabled"])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ha,{modelValue:Ll.show,"onUpdate:modelValue":Oe[34]||(Oe[34]=e=>Ll.show=e),"max-width":"800"},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-subtitle-1 d-flex align-center px-3 py-1 bg-primary-lighten-5"},{default:s(()=>[t(De,{icon:Ll.isLocal?"mdi-folder-search":"mdi-folder-network",class:"mr-2",color:"primary"},null,8,["icon"]),i("span",null,n(Ll.isLocal?"选择本地目录":"选择网盘目录"),1)]),_:1}),t(Sl,{class:"px-3 py-2"},{default:s(()=>[Ll.loading?(o(),u("div",Ee,[t(Va,{indeterminate:"",color:"primary"})])):(o(),u("div",Ie,[t(va,{modelValue:Ll.currentPath,"onUpdate:modelValue":Oe[33]||(Oe[33]=e=>Ll.currentPath=e),label:"当前路径",variant:"outlined",density:"compact",class:"mb-2",onKeyup:y(Nl,["enter"])},null,8,["modelValue"]),t(zl,{class:"border rounded","max-height":"300px","overflow-y":"auto"},{default:s(()=>["/"!==Ll.currentPath&&"C:\\"!==Ll.currentPath&&"C:/"!==Ll.currentPath?(o(),c(Ze,{key:0,onClick:Wl,class:"py-0",style:{"min-height":"auto"}},{prepend:s(()=>[t(De,{icon:"mdi-arrow-up",size:"small",class:"mr-2",color:"grey"})]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>Oe[142]||(Oe[142]=[r("上级目录")])),_:1}),t(ra,null,{default:s(()=>Oe[143]||(Oe[143]=[r("..")])),_:1})]),_:1})):d("",!0),(o(!0),u(p,null,m(Ll.items,(e,l)=>(o(),c(Ze,{key:l,onClick:l=>(e=>{e&&e.is_dir&&e.path&&(Ll.currentPath=e.path,Nl())})(e),disabled:!e.is_dir,class:"py-0",style:{"min-height":"auto"}},{prepend:s(()=>[t(De,{icon:e.is_dir?"mdi-folder":"mdi-file",size:"small",class:"mr-2",color:e.is_dir?"success":"blue"},null,8,["icon","color"])]),default:s(()=>[t(Ke,{class:"text-body-2"},{default:s(()=>[r(n(e.name),1)]),_:2},1024)]),_:2},1032,["onClick","disabled"]))),128)),Ll.items.length?d("",!0):(o(),c(Ze,{key:1,class:"py-2 text-center"},{default:s(()=>[t(Ke,{class:"text-body-2 text-grey"},{default:s(()=>Oe[144]||(Oe[144]=[r("该目录为空或访问受限")])),_:1})]),_:1}))]),_:1})])),"/"!==Ll.currentPath||Ll.isLocal?d("",!0):(o(),c(We,{key:2,type:"warning",density:"compact",class:"mt-2 text-caption",variant:"tonal",icon:"mdi-alert-circle-outline"},{default:s(()=>Oe[145]||(Oe[145]=[r(" 115离线下载不支持选择根目录，请选择或进入一个子目录。 ")])),_:1})),Ll.error?(o(),c(We,{key:3,type:"error",density:"compact",class:"mt-2 text-caption",variant:"tonal"},{default:s(()=>[r(n(Ll.error),1)]),_:1})):d("",!0)]),_:1}),t(fa,{class:"px-3 py-1"},{default:s(()=>[t(ca),t(da,{color:"primary",onClick:ql,disabled:!Ll.currentPath||Ll.loading||"/"===Ll.currentPath&&!Ll.isLocal,variant:"text",size:"small"},{default:s(()=>Oe[146]||(Oe[146]=[r(" 选择当前目录 ")])),_:1},8,["disabled"]),t(da,{color:"grey",onClick:Kl,variant:"text",size:"small"},{default:s(()=>Oe[147]||(Oe[147]=[r(" 取消 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ha,{modelValue:cl.value,"onUpdate:modelValue":Oe[36]||(Oe[36]=e=>cl.value=e),"max-width":"500",persistent:""},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-h6 d-flex align-center"},{default:s(()=>[t(De,{icon:"mdi-alert-circle-outline",color:"warning",class:"mr-2"}),Oe[148]||(Oe[148]=r(" 确认操作 "))]),_:1}),t(Sl,null,{default:s(()=>[Oe[150]||(Oe[150]=i("div",{class:"mb-2"},"您确定要立即执行全量同步吗？",-1)),e.initialConfig?.full_sync_media_server_refresh_enabled?(o(),c(We,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-2",icon:"mdi-alert"},{default:s(()=>Oe[149]||(Oe[149]=[i("div",{class:"text-body-2 mb-1"},[i("strong",null,"重要警告")],-1),i("div",{class:"text-caption"}," 全量同步完成后将自动刷新整个媒体库，此操作会扫描所有媒体文件，可能导致媒体服务器负载增加。请确保您已了解此风险并自行承担相应责任。 ",-1)])),_:1})):d("",!0)]),_:1}),t(fa,null,{default:s(()=>[t(ca),t(da,{color:"grey",variant:"text",onClick:Oe[35]||(Oe[35]=e=>cl.value=!1),disabled:el.value},{default:s(()=>Oe[151]||(Oe[151]=[r(" 取消 ")])),_:1},8,["disabled"]),t(da,{color:"warning",variant:"text",onClick:Vl,loading:el.value},{default:s(()=>Oe[152]||(Oe[152]=[r(" 确认执行 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ha,{modelValue:dl.value,"onUpdate:modelValue":Oe[38]||(Oe[38]=e=>dl.value=e),"max-width":"450",persistent:""},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-h6 d-flex align-center"},{default:s(()=>[t(De,{icon:"mdi-alert-circle-outline",color:"warning",class:"mr-2"}),Oe[153]||(Oe[153]=r(" 确认操作 "))]),_:1}),t(Sl,null,{default:s(()=>Oe[154]||(Oe[154]=[r(" 您确定要立即执行全量同步数据库吗？该操作会覆盖原有数据库数据 ")])),_:1}),t(fa,null,{default:s(()=>[t(ca),t(da,{color:"grey",variant:"text",onClick:Oe[37]||(Oe[37]=e=>dl.value=!1),disabled:ll.value},{default:s(()=>Oe[155]||(Oe[155]=[r(" 取消 ")])),_:1},8,["disabled"]),t(da,{color:"warning",variant:"text",onClick:Ml,loading:ll.value},{default:s(()=>Oe[156]||(Oe[156]=[r(" 确认执行 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ha,{modelValue:_l.show,"onUpdate:modelValue":Oe[40]||(Oe[40]=e=>_l.show=e),"max-width":"900",scrollable:""},{default:s(()=>[t(Tl,null,{default:s(()=>[t(Ne,{class:"text-subtitle-1 d-flex align-center px-3 py-2 bg-primary-gradient"},{default:s(()=>[t(De,{icon:"mdi-history",class:"mr-2",color:"primary",size:"small"}),i("span",null,"同步删除历史记录 (共 "+n(ul.value.length)+" 条)",1),t(ca),t(da,{icon:"",size:"x-small",variant:"text",onClick:ta,loading:ml.value},{default:s(()=>[t(De,null,{default:s(()=>Oe[157]||(Oe[157]=[r("mdi-refresh")])),_:1})]),_:1},8,["loading"]),t(da,{icon:"",size:"small",variant:"text",onClick:Oe[39]||(Oe[39]=e=>_l.show=!1)},{default:s(()=>[t(De,null,{default:s(()=>Oe[158]||(Oe[158]=[r("mdi-close")])),_:1})]),_:1})]),_:1}),t(Sl,{class:"pa-0 sync-del-history-content"},{default:s(()=>[ml.value?(o(),c(qe,{key:0,type:"list-item-avatar-three-line@5"})):0===ul.value.length?(o(),u("div",Re,[t(De,{icon:"mdi-information-outline",size:"large",color:"grey",class:"mb-2"}),Oe[159]||(Oe[159]=i("div",{class:"text-caption text-grey"},"暂无删除历史",-1))])):(o(),c(zl,{key:2,class:"bg-transparent pa-0"},{default:s(()=>[(o(!0),u(p,null,m(ul.value,(e,l)=>(o(),u(p,{key:e.unique||l},[t(Ze,{class:"px-3 py-2"},{prepend:s(()=>[t(na,{size:"56",rounded:"",class:"mr-3"},{default:s(()=>[e.image?(o(),c(sa,{key:0,src:e.image,alt:e.title,cover:""},null,8,["src","alt"])):(o(),c(De,{key:1,icon:"mdi-movie"}))]),_:2},1024)]),append:s(()=>[t(da,{icon:"",size:"small",variant:"text",color:"error",onClick:l=>ia(e.unique),loading:pl.value===e.unique},{default:s(()=>[t(De,null,{default:s(()=>Oe[160]||(Oe[160]=[r("mdi-delete")])),_:1})]),_:2},1032,["onClick","loading"])]),default:s(()=>[t(Ke,{class:"text-body-1 font-weight-medium"},{default:s(()=>[r(n(e.title),1)]),_:2},1024),t(ra,{class:"text-caption"},{default:s(()=>[i("div",Le,[t(Ge,{size:"small",variant:"tonal",color:"primary"},{default:s(()=>[r(n(e.type),1)]),_:2},1024),e.year?(o(),u("span",Fe,"· "+n(e.year),1)):d("",!0),e.season?(o(),u("span",Be,"· S"+n(String(e.season).padStart(2,"0")),1)):d("",!0),e.episode?(o(),u("span",je,"· E"+n(String(e.episode).padStart(2,"0")),1)):d("",!0)]),e.path?(o(),u("div",Ae,n(e.path),1)):d("",!0),i("div",He,n(e.del_time),1)]),_:2},1024)]),_:2},1024),l<ul.value.length-1?(o(),c(fl,{key:0,class:"my-0"})):d("",!0)],64))),128))]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-8a779e88"]]);export{Ge as default};
